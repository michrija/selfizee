// Initialisation tooltip
function initTooltip(){
	jQuery('[data-toggle="tooltip"]')
		.tooltip('destroy')
		.tooltip();
}

// Initialisation popover
function initPopover(){
	jQuery('[data-toggle="popover"]')
		.popover('destroy')
		.popover();
}

// Modal personnalisé
function ouvrirModal(titre, message, bouton, type, largeur){
	// Type message : modal-success
	var $types = new Array(
		'',
		'modal-primary',
		'modal-info',
		'modal-warning',
		'modal-success',
		'modal-danger'
	);
	
	if(typeof type != 'undefined')
		if(typeof $types[type] != 'undefined')
			var $type = $types[type];
		else
			var $type = $types[0];
	else
		var $type = $types[0];
	
	
	// Largeur fenêtre
	if(typeof largeur == 'undefined'){
		largeur = 'modal-sm';
	}else{
		if(typeof largeur == 'boolean' && largeur == true)
			largeur = 'modal-lg';
		else if(jQuery.trim(largeur) == 'modal-lg')
			largeur = 'modal-lg';
		else if(typeof largeur == 'boolean' && largeur == false)
			largeur = '';
		else
			largeur = 'modal-sm';
	}
	
	
	var nouveau_modal_info = '<div class="modal '+ $type +' fade bs-example-' + largeur + '" id="informationModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">';
	nouveau_modal_info += '<div class="modal-dialog ' + largeur + '">';
	nouveau_modal_info += '<div class="modal-content">';
	nouveau_modal_info += '<div class="modal-header"><h4 class="modal-title">Modal title</h4><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only"></span></button></div>';
	nouveau_modal_info += '<div class="modal-body"></div>';
	nouveau_modal_info += '<div class="modal-footer"></div>';
	nouveau_modal_info += '</div></div></div>';
	
	// Append container
	if(jQuery('body').find('#informationModal').length > 0){
		if(jQuery('#informationModal').css('display') != 'none')
			return false;
		
		jQuery('body').find('#informationModal').remove();
	}
		
	if(jQuery('body').find('.modal-backdrop').length > 0)
		jQuery('body').find('.modal-backdrop').remove();
		
	// jQuery('#el_container_compte').append(nouveau_modal_info);
	jQuery('body').append(nouveau_modal_info);
	
	var informationModal = jQuery('#informationModal').on('show.bs.modal', function (event){
		var modal = jQuery(this);
		// Titre
		modal.find('.modal-title').html(titre);
		
		// Contenu
		modal.find('.modal-body').html(message);
		
		// Footer
		modal.find('.modal-footer').empty().html(bouton);
		
	}).on('hidden.bs.modal', function (event){
		// Effacer les dernier contenu du popup
		jQuery('#informationModal').find('.modal-title').html('');
		jQuery('#informationModal').find('.modal-body').html('');
		jQuery('#informationModal').find('.modal-footer').html('');
		
		// modal-backdrop
		if(jQuery('body').find('.modal-backdrop').length > 0)
			jQuery('body').find('.modal-backdrop').remove();
		// modal-scrollable
		if(jQuery('body').find('.modal-scrollable').length > 0)
			jQuery('body').find('.modal-scrollable').remove();
			
		// Vide l'image gallerie en cours d'editions
		if(jQuery('.img_gal_edit').length > 0)
			jQuery('.img_gal_edit').val('');
	}).modal({ backdrop: 'static' })
	.modal('show');
}

// Confirmation de suppresion champ
function SupprimerElement(params){
	var titre = params.params_titre;
	var message = '<p>' + params.params_description + '</p>';
	
	var boutton = '';
	if(params.params_btn_fermer != 'undefined')
		boutton += '<button type="button" class="btn btn-default btn-flat btn-sm" data-dismiss="modal">Fermer</button>';
	boutton += '<button type="button" class="btn btn-primary btn-flat btn-sm" onClick="SupprimerElementConfirme(\'' + params.params_action + '\')">' + params.params_btn_action + '</button>';
	ouvrirModal(titre, message, boutton);
}

// Validation de suppresion champ
function SupprimerElementConfirme(objet){
	jQuery('#informationModal').modal('hide');
	jQuery(location).attr('href', objet);
}

jQuery(document).ready(function(){
	// Fermeture popup 2
	jQuery('.informationModalCenter').delegate('.el_fermer_model', 'click', function() {
		jQuery('.informationModalCenter').animate(
			{
				'opacity' : 0, 
				'top' : (parseInt(jQuery('.informationModalCenter').css('top')) + 200) + 'px'
			}, 
			500, 
			function(){
				jQuery('#informationModalCenter').css({'display': 'none', 'z-index' : -1 });
				jQuery('.informationModalCenter').html('');
				jQuery('body').css({'overflow': 'auto'});
			}
		);
	});
	
});

// Modal personnalisé 2 centre
function ouvrirModalCentre(message, iframe, grand, largeur){
	if(typeof message == 'undefined')
		return;
	
	var img_fermer = 'el_fermer2.png';
	var opacity_fermer = '';
	
	dans_ifram = false;
	if(typeof iframe !== 'undefined')
		if(iframe === true)
			dans_ifram = true;
	
	grand_fenetre = false;
	if(typeof grand !== 'undefined')
		if(grand === true)
			grand_fenetre = true;
	
	largeur_fenetre = false;
	if(typeof largeur !== 'undefined')
		if(parseInt(largeur) > 200){
			largeur_fenetre = parseInt(largeur);
			img_fermer = 'el_fermer3.png';
			opacity_fermer = ' style="opacity:0.8"';
		}
	
	if(jQuery('#informationModalCenter').css('display') == 'block')
		return;
	
	informationModalCenterCt = '' +
		'<button class="close el_modal_fermer el_btn_annuler el_btn_fermer el_fermer_model" type="button"'+opacity_fermer+'>' +
			'<img src="/img/front/' + img_fermer + '" alt="Fermer">' +
		'</button>' +
		'<div class="informationModalCenterCt">' + message + '</div>';
	
	
	if(dans_ifram){
		var elemCT = jQuery(window.parent.document).find('#informationModalCenter');
		var elem = jQuery(window.parent.document).find('.informationModalCenter');
	}else{
		var elemCT = jQuery('#informationModalCenter');
		var elem = jQuery('.informationModalCenter');
	}
	
	
	elem.html(informationModalCenterCt);
	elemCT.css({'display': 'block', 'z-index' : -1 });
	// Fenetre pour les information médias
	if(largeur_fenetre){
		elem.css({'width': largeur_fenetre });
		jQuery(elem).find('.informationModalCenterCt').css({'max-height' : '100%'});
	}
	if(grand_fenetre){
		if(dans_ifram)
			height = jQuery(window.parent.document).height();
		else
			height = jQuery(window).height();
		
		height = height - (66 * 2);
		elem.css(
			{
				'height': height,
				'max-height': height
			}
		);
		jQuery(elem).children('.informationModalCenterCt').css({
			'height': height - (40 * 2),
			'max-height': height - (40 * 2)
		});
	}
	
	elem.animate(
		{ opacity: 1 }, 
		0, 
		function(){
			$w_height = jQuery(window).innerHeight();
			$p_height = elem.outerHeight();
			if(largeur_fenetre === false){
				elem.find(".informationModalCenterCt").mCustomScrollbar({
					theme : 'inset-2-dark',
					scrollbarPosition: 'outside',
				});
			}
			
			// Fenêtre normal
			$p_top = ($w_height - $p_height) / 2;
			
			elemCT.css({'display': 'block', 'z-index' : 10000 });
			elem.css({opacity: 0});
			
			// Margin-top du modal
			var $top_media = 100;
			
			if(largeur_fenetre){
				elem.css({
					maxHeight : 'none',
				}).children('.informationModalCenterCt').css({
					overflow : 'visible'
				});
				
				var medias = jQuery('#informationModalCenter').find('video');
				if(medias.length > 0)
					$top_media = 40;
			}
			
			elem.animate(
				{ opacity: 1 , 'top' : largeur_fenetre ? $top_media : $p_top}, 
				500, 
				function(){ }
			);
		}
	);
	if(largeur_fenetre)
		elemCT.css({'overflow': 'auto'});
	
	jQuery('body').css({'overflow': 'hidden'});
}
